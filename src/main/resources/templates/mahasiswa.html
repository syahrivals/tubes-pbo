<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="layout :: layout(~{::section})" lang="id">
<section>
    <!-- Page Header -->
    <div class="page-header animate-fade-in mb-4">
        <div class="row align-items-center">
            <div class="col-lg-8">
                <h4 class="page-title mb-1">
                    <i class="bi bi-people-fill text-primary me-2"></i>
                    Kelola Data Mahasiswa
                </h4>
                <p class="text-muted mb-0">Tambah dan kelola data mahasiswa terdaftar</p>
            </div>
            <div class="col-lg-4 text-lg-end mt-3 mt-lg-0">
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addModal">
                    <i class="bi bi-person-plus me-2"></i>Tambah Mahasiswa
                </button>
            </div>
        </div>
    </div>

    <!-- Alerts -->
    <div th:if="${success}" class="alert alert-success alert-dismissible fade show animate-fade-in mb-4">
        <i class="bi bi-check-circle-fill me-2"></i>
        <span th:text="${success}">Success</span>
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
    <div th:if="${error}" class="alert alert-danger alert-dismissible fade show animate-fade-in mb-4">
        <i class="bi bi-exclamation-triangle-fill me-2"></i>
        <span th:text="${error}">Error</span>
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>

    <!-- Stats -->
    <div class="row g-4 mb-4">
        <div class="col-md-4 animate-fade-in">
            <div class="card stat-card h-100">
                <div class="card-body text-center py-4">
                    <div class="stat-icon primary mx-auto">
                        <i class="bi bi-people-fill"></i>
                    </div>
                    <h2 class="stat-number" th:text="${list != null ? list.size() : 0}">0</h2>
                    <p class="stat-label mb-0">Total Mahasiswa</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Mahasiswa Grid -->
    <div class="row g-4">
        <div class="col-md-6 col-lg-4 animate-fade-in" th:each="m, iterStat : ${list}"
            th:style="${'animation-delay: ' + (iterStat.index * 0.05) + 's'}">
            <div class="student-card-v2">
                <div class="student-header">
                    <div class="student-avatar" th:text="${m.nama.substring(0, 1).toUpperCase()}">B</div>
                    <div class="student-info">
                        <h6 class="student-name" th:text="${m.nama}">Nama</h6>
                        <span class="student-nim">
                            <i class="bi bi-hash me-1"></i><span th:text="${m.nim}">NIM</span>
                        </span>
                    </div>
                </div>
                <div class="student-meta">
                    <span class="meta-item">
                        <i class="bi bi-person"></i>
                        <span th:text="${m.username}">username</span>
                    </span>
                </div>
                <div class="student-actions">
                    <a th:href="@{'/report/' + ${m.nim}}" class="btn btn-sm btn-outline-primary flex-fill">
                        <i class="bi bi-file-earmark-pdf me-1"></i>Report
                    </a>
                    <form th:action="@{/mahasiswa/{nim}/delete(nim=${m.nim})}" method="post" class="d-inline"
                        onsubmit="return confirm('Yakin hapus mahasiswa ini?')">
                        <button type="submit" class="btn btn-sm btn-outline-danger">
                            <i class="bi bi-trash"></i>
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Empty State -->
        <div class="col-12" th:if="${#lists.isEmpty(list)}">
            <div class="empty-state">
                <div class="empty-state-icon">ðŸ‘¥</div>
                <h5 class="empty-state-title">Belum Ada Mahasiswa</h5>
                <p class="empty-state-text">Klik tombol "Tambah Mahasiswa" untuk mulai menambahkan data.</p>
            </div>
        </div>
    </div>

    <!-- Add Modal -->
    <div class="modal fade" id="addModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="bi bi-person-plus text-primary me-2"></i>Tambah Mahasiswa
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form method="post" action="/mahasiswa">
                    <div class="modal-body">
                        <div class="mb-3">
                            <label class="form-label"><i class="bi bi-hash me-1"></i>NIM</label>
                            <input name="nim" class="form-control" placeholder="6 digit angka" required
                                pattern="[0-9]{6}">
                        </div>
                        <div class="mb-3">
                            <label class="form-label"><i class="bi bi-person me-1"></i>Nama</label>
                            <input name="nama" class="form-control" placeholder="Nama lengkap" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label"><i class="bi bi-at me-1"></i>Username</label>
                            <input name="username" class="form-control" placeholder="Username untuk login" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label"><i class="bi bi-lock me-1"></i>Password</label>
                            <input name="password" type="password" class="form-control" placeholder="Minimal 4 karakter"
                                required minlength="4">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Batal</button>
                        <button type="submit" class="btn btn-primary"><i class="bi bi-check-lg me-1"></i>Simpan</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Styles -->
    <style>
        .page-header {
            padding: 1.5rem;
            background: var(--surface);
            border-radius: var(--radius-xl);
            border: 1px solid var(--glass-border);
        }

        .page-title {
            font-family: var(--font-display);
            font-weight: 800;
            color: var(--text-primary);
        }

        .student-card-v2 {
            background: var(--surface);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-xl);
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        .student-card-v2:hover {
            border-color: var(--primary-500);
            transform: translateY(-4px);
            box-shadow: 0 12px 30px rgba(99, 102, 241, 0.15);
        }

        .student-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .student-avatar {
            width: 52px;
            height: 52px;
            background: var(--gradient-primary);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.4rem;
            color: white;
            box-shadow: 0 8px 20px rgba(99, 102, 241, 0.3);
        }

        .student-name {
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.125rem;
        }

        .student-nim {
            font-size: 0.85rem;
            color: var(--text-muted);
            font-family: var(--font-mono);
        }

        .student-meta {
            padding: 0.75rem 0;
            border-top: 1px solid var(--glass-border);
            border-bottom: 1px solid var(--glass-border);
            margin-bottom: 1rem;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .meta-item i {
            width: 28px;
            height: 28px;
            background: rgba(99, 102, 241, 0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-400);
        }

        .student-actions {
            display: flex;
            gap: 0.5rem;
        }
    </style>
</section>

</html>
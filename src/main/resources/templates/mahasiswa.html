<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="layout :: layout(~{::section})">
<section>
    <div class="d-flex justify-content-between align-items-center mb-3">
        <div>
            <h5 class="mb-0">ğŸ‘¥ Daftar Mahasiswa</h5>
            <p class="text-muted small mb-0">
                Total: <strong th:text="${mahasiswaList.size()}">0</strong> mahasiswa terdaftar
            </p>
        </div>
        <div>
            <span class="badge bg-info me-2">
                ğŸ’¡ Mahasiswa bisa register sendiri di /register
            </span>
            <a class="btn btn-outline-secondary btn-sm" href="/">Dashboard</a>
        </div>
    </div>

    <!-- Table View -->
    <div class="card shadow-soft">
        <div class="card-body">
            <div th:if="${#lists.isEmpty(mahasiswaList)}" class="alert alert-light text-center">
                <p class="mb-2">Belum ada mahasiswa terdaftar.</p>
                <small class="text-muted">
                    Mahasiswa bisa mendaftar melalui halaman <a href="/register" target="_blank">Registration</a>
                </small>
            </div>

            <div class="table-responsive" th:if="${!#lists.isEmpty(mahasiswaList)}">
                <table class="table table-hover align-middle mb-0">
                    <thead class="table-light">
                    <tr>
                        <th width="5%">#</th>
                        <th width="15%">NIM</th>
                        <th width="30%">Nama Lengkap</th>
                        <th width="20%">Username</th>
                        <th width="15%" class="text-center">Jumlah Nilai</th>
                        <th width="15%" class="text-center">Aksi</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="m, iter : ${mahasiswaList}" th:if="${m != null}">
                        <td class="fw-bold text-muted" th:text="${iter.index + 1}">1</td>
                        <td>
                            <span class="badge bg-primary-subtle text-primary" th:text="${m.nim}">220001</span>
                        </td>
                        <td class="fw-semibold" th:text="${m.nama != null ? m.nama : '-'}">Nama Mahasiswa</td>
                        <td>
                            <code th:text="${m.username != null ? m.username : '-'}">username</code>
                        </td>
                        <td class="text-center">
                            <span class="badge bg-success" 
                                  th:if="${nilaiMap != null && nilaiMap[m.nim] != null && !nilaiMap[m.nim].isEmpty()}"
                                  th:text="${nilaiMap[m.nim].size()} + ' nilai'">
                                0 nilai
                            </span>
                            <span class="badge bg-secondary" 
                                  th:if="${nilaiMap == null || nilaiMap[m.nim] == null || nilaiMap[m.nim].isEmpty()}">
                                Belum ada
                            </span>
                        </td>
                        <td class="text-center">
                            <a class="btn btn-sm btn-outline-primary" 
                               th:href="@{'/report/' + ${m.nim}}"
                               title="Generate Report">
                                ğŸ“„ Report
                            </a>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Info Card -->
    <div class="alert alert-info border-0 shadow-sm mt-3">
        <div class="d-flex align-items-center">
            <div class="me-3" style="font-size: 2rem;">â„¹ï¸</div>
            <div>
                <strong>Informasi:</strong>
                <ul class="mb-0 mt-2">
                    <li>Mahasiswa baru bisa mendaftar melalui halaman <a href="/register" class="alert-link">Registration</a></li>
                    <li>Password default otomatis di-hash dengan BCrypt untuk keamanan</li>
                    <li>Untuk melihat detail nilai mahasiswa, gunakan tombol "Report"</li>
                    <li>Data mahasiswa tidak bisa dihapus dari sini (untuk mencegah kehilangan data)</li>
                </ul>
            </div>
        </div>
    </div>
</section>
</html>

